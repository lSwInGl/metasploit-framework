<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Msf::WebServices::FrameworkExtension
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Msf::WebServices::FrameworkExtension";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (F)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../WebServices.html" title="Msf::WebServices (module)">WebServices</a></span></span>
     &raquo; 
    <span class="title">FrameworkExtension</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Msf::WebServices::FrameworkExtension
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/msf/core/web_services/framework_extension.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Extension provides a Metasploit Framework instance to a Sinatra
application. The framework instance is stored with the setting name
framework and is also accessible via the framework helper method. If the
data service URL environment variable is set, then the framework instance
will be configured to use the data service rather than the local database.</p>

<p>Environment Variables: MSF_WS_DATA_SERVICE_URL - The data service URL.
MSF_WS_DATA_SERVICE_API_TOKEN - API token used to authenticate to the
remote data service. MSF_WS_DATA_SERVICE_CERT - Certificate file matching
the remote data server&#39;s certificate.</p>

<pre class="code ruby"><code class="ruby">Needed when using self-signed SSL certificates.</code></pre>

<p>MSF_WS_DATA_SERVICE_SKIP_VERIFY - (Boolean) Skip validating authenticity of
server&#39;s certificate.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="FrameworkExtension/Helpers.html" title="Msf::WebServices::FrameworkExtension::Helpers (module)">Helpers</a></span>
    
  
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="FALSE_VALUES-constant" class="">FALSE_VALUES =
          
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>f</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>false</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>off</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>no</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_set'>to_set</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#framework_db_connect_http_data_service-class_method" title="framework_db_connect_http_data_service (class method)">.<strong>framework_db_connect_http_data_service</strong>(framework:, data_service_url:, api_token: nil, cert: nil, skip_verify: false)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#registered-class_method" title="registered (class method)">.<strong>registered</strong>(app)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="framework_db_connect_http_data_service-class_method">
  
    .<strong>framework_db_connect_http_data_service</strong>(framework:, data_service_url:, api_token: nil, cert: nil, skip_verify: false)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/web_services/framework_extension.rb', line 50</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_framework_db_connect_http_data_service'>framework_db_connect_http_data_service</span><span class='lparen'>(</span>
    <span class='label'>framework:</span><span class='comma'>,</span> <span class='label'>data_service_url:</span><span class='comma'>,</span> <span class='label'>api_token:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>cert:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>skip_verify:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='comment'># local database is required to use Mdm objects
</span>  <span class='kw'>unless</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No local database connected</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_https_opts'>https_opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_data_service_url'>data_service_url</span> <span class='kw'>unless</span> <span class='id identifier rubyid_data_service_url'>data_service_url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:api_token</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_api_token'>api_token</span> <span class='kw'>unless</span> <span class='id identifier rubyid_api_token'>api_token</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_https_opts'>https_opts</span><span class='lbracket'>[</span><span class='symbol'>:cert</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cert'>cert</span> <span class='kw'>unless</span> <span class='id identifier rubyid_cert'>cert</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_https_opts'>https_opts</span><span class='lbracket'>[</span><span class='symbol'>:skip_verify</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_skip_verify'>skip_verify</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_verify'>skip_verify</span>
  <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:https_opts</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_https_opts'>https_opts</span> <span class='kw'>unless</span> <span class='id identifier rubyid_https_opts'>https_opts</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

  <span class='kw'>begin</span>
    <span class='id identifier rubyid_uri'><span class='object_link'><a href="../../top-level-namespace.html#uri-instance_method" title="#uri (method)">uri</a></span></span> <span class='op'>=</span> <span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_data_service_url'>data_service_url</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_remote_data_service'>remote_data_service</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Metasploit.html" title="Metasploit (module)">Metasploit</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework.html" title="Metasploit::Framework (module)">Framework</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/DataService.html" title="Metasploit::Framework::DataService (module)">DataService</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Metasploit/Framework/DataService/RemoteHTTPDataService.html" title="Metasploit::Framework::DataService::RemoteHTTPDataService (class)">RemoteHTTPDataService</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Metasploit/Framework/DataService/RemoteHTTPDataService.html#initialize-instance_method" title="Metasploit::Framework::DataService::RemoteHTTPDataService#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_uri'><span class='object_link'><a href="../../top-level-namespace.html#uri-instance_method" title="#uri (method)">uri</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_register_data_service'>register_data_service</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_data_service'>remote_data_service</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_workspace'>workspace</span> <span class='op'>=</span> <span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span><span class='period'>.</span><span class='id identifier rubyid_default_workspace'>default_workspace</span>
  <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to connect to the HTTP data service: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="registered-class_method">
  
    .<strong>registered</strong>(app)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/core/web_services/framework_extension.rb', line 30</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_registered'>registered</span><span class='lparen'>(</span><span class='id identifier rubyid_app'>app</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_helpers'>helpers</span> <span class='const'><span class='object_link'><a href="" title="Msf::WebServices::FrameworkExtension (module)">FrameworkExtension</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="FrameworkExtension/Helpers.html" title="Msf::WebServices::FrameworkExtension::Helpers (module)">Helpers</a></span></span>

  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='symbol'>:data_service_url</span><span class='comma'>,</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MSF_WS_DATA_SERVICE_URL</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='symbol'>:data_service_api_token</span><span class='comma'>,</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MSF_WS_DATA_SERVICE_API_TOKEN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='symbol'>:data_service_cert</span><span class='comma'>,</span> <span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MSF_WS_DATA_SERVICE_CERT</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='symbol'>:data_service_skip_verify</span><span class='comma'>,</span> <span class='id identifier rubyid_to_bool'>to_bool</span><span class='lparen'>(</span><span class='const'>ENV</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MSF_WS_DATA_SERVICE_SKIP_VERIFY</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='comment'># Create simplified instance of the framework
</span>  <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span> <span class='symbol'>:framework</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Simple.html" title="Msf::Simple (module)">Simple</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Simple/Framework.html" title="Msf::Simple::Framework (module)">Framework</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="../Simple/Framework.html#create-class_method" title="Msf::Simple::Framework.create (method)">create</a></span></span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_url'>data_service_url</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_url'>data_service_url</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_framework_db_connect_http_data_service'>framework_db_connect_http_data_service</span><span class='lparen'>(</span><span class='label'>framework:</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='comma'>,</span>
                                           <span class='label'>data_service_url:</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_url'>data_service_url</span><span class='comma'>,</span>
                                           <span class='label'>api_token:</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_api_token'>data_service_api_token</span><span class='comma'>,</span>
                                           <span class='label'>cert:</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_cert'>data_service_cert</span><span class='comma'>,</span>
                                           <span class='label'>skip_verify:</span> <span class='id identifier rubyid_app'>app</span><span class='period'>.</span><span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_data_service_skip_verify'>data_service_skip_verify</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed May 29 00:38:34 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.3.3).
</div>

    </div>
  </body>
</html>